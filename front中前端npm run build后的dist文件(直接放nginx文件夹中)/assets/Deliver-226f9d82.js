import{useUserStore as h}from"./login-a476a6d2.js";import{a as i}from"./axios-760d4776.js";import{j as p,r as l,o as f,c as m,b as a,w as u,a as c,k as w,l as D,n as d,p as v,t as S}from"./index-38b3b81d.js";const C={class:"Deliverpage"},g=c("div",{class:"deliverInform"},[c("strong",null,"您的需配订单")],-1),T=p({data(){let r=w([]);r=D(r);const n=h();if(n.user==="manager"){const e=async()=>{await i.get("http://43.143.167.222:8020/Delivery/").then(s=>{r.value=s.data.map(t=>t.Current_Status===2?{...t,buttonText:"已送达"}:t.Current_Status===1?{...t,buttonText:"配送中"}:{...t,buttonText:"即将配送"})})};d(()=>{e()})}else{const e=async()=>{await i.get(`http://43.143.167.222:8020/Delivery/?DID=${n.id}`).then(s=>{r.value=s.data.map(t=>t.Current_Status===2?{...t,buttonText:"已送达"}:t.Current_Status===1?{...t,buttonText:"配送中"}:{...t,buttonText:"即将配送"})})};d(()=>{e()})}return{tableData:r,changeStatusOfOrder:(e,s)=>{const t=r.value[e];if(t.Current_Status==0)t.Current_Status="1",t.buttonText="配送中";else if(t.Current_Status==1){t.Current_Status="2";const _=new Date().toISOString();t.Completion_Time=_,s.isActive=!0,t.buttonText="已送达"}else t.Current_Status="2"}}},methods:{statusStyle(r){switch(console.log(r),r){case 0:return"statusRed";case"0":return"statusRed";case 1:return"statusYellow";case"1":return"statusYellow";case 2:return"statusGreen";case"2":return"statusGreen"}}}}),B=p({...T,__name:"Deliver",setup(r){return(n,b)=>{const e=l("el-table-column"),s=l("el-button"),t=l("el-table"),_=l("el-card");return f(),m("div",C,[g,a(_,{class:"deliverTable"},{default:u(()=>[a(t,{data:n.tableData,"default-sort":{prop:"date",order:"descending"},style:{width:"100%"},class:"myform_deliver"},{default:u(()=>[a(e,{prop:"Dispatcher_ID",label:"配送编号",sortable:"",width:"130"}),a(e,{prop:"Order_ID",label:"订单编号",width:"130"}),a(e,{prop:"Order_ID__orderdetail__ProductBatch_ID",label:"产品批次号",width:"145"}),a(e,{prop:"Order_ID__orderdetail__ProductBatch_ID__ProductBatch_Expiration_Time",label:"最晚送达时间",width:"240"}),a(e,{prop:"Completion_Time",label:"配送完成时间",width:"240"}),a(e,{prop:"Vehicle_ID",label:"车辆编号",width:"200"}),a(e,{prop:"Order_ID__Order_Destination",label:"目标位置",width:"270"}),a(e,{label:"订单状态",width:"220"},{default:u(o=>[a(s,{class:v(["statusButton",n.statusStyle(o.row.Current_Status)]),onClick:x=>n.changeStatusOfOrder(o.$index,o.row)},{default:u(()=>[c("strong",null,S(o.row.buttonText),1)]),_:2},1032,["class","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}});export{B as default};
