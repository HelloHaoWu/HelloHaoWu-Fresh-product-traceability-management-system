import{a as n}from"./axios-760d4776.js";import{useUserStore as k}from"./login-a476a6d2.js";import{_ as N,r as _,o as h,c as u,a as e,g as P,v as b,h as I,e as T,b as c,w as p,F as w,i as B,t as l,f as V}from"./index-38b3b81d.js";const x={name:"AppBlockDetail",data(){const t=k();return{user:t.user,userid:t.id,total:0,customerdetail:[],orders:[],current_page:1,pageData:{page:1,limit:16},searchValue:"",newValue_search:""}},created(){this.Loadcustomerdata()},watch:{searchValue(t){n.get(`http://43.143.167.222:8020/Customer/?CNAME=${t}`).then(s=>{if(console.log(s.data),s.data===!1)alert("查询结果为空，即将清空搜索栏，请尝试再次查询。"),this.loadData(),this.searchValue="";else{this.pageData.page=1,this.orders=[],this.current_page=1;for(let a=(this.pageData.page-1)*this.pageData.limit,r=0;r<this.pageData.limit&&(this.orders[r]=s.data[a],r++,a!==s.data.length-1);a++);this.newValue_search=t,this.total=s.data.length||0}})}},methods:{replace(t){return t.replace("T"," ").replace("Z"," ")},Rotate_and_show(t){const s=document.getElementsByClassName("detail_click"),a=document.getElementsByClassName("detail_data_incustomer");s[t].classList.toggle("rotate");var r=1*51+45+5;a[t].style.height===r.toString()+"px"?a[t].style.height="0px":a[t].style.height=r.toString()+"px",a[t].classList.toggle("showCollapse")},JudgeColor_FromNum(t){return t===0?"warning":t===1?"":"success"},JudgeText_FromNum(t){return t===0?"未配送":t===1?"配送中":"已配送"},Loadcustomerdata(){this.user==="manager"?n.get("http://43.143.167.222:8020/Customer/").then(t=>{console.log("你是经理",t.data),this.customerdetail=t.data;var s=this.customerdetail;this.total=s.length||0,console.log(this.total),this.orders=[];for(let a=(this.pageData.page-1)*this.pageData.limit,r=0;r<this.pageData.limit&&(this.orders[r]=s[a],r++,a!==s.length-1);a++);}):n.get(`http://43.143.167.222:8020/Customer/?CID=${this.userid}`).then(t=>{console.log("你是顾客",t.data),this.customerdetail=t.data;var s=this.customerdetail;this.total=s.length||0,console.log(this.total),this.orders=[];for(let a=(this.pageData.page-1)*this.pageData.limit,r=0;r<this.pageData.limit&&(this.orders[r]=s[a],r++,a!==s.length-1);a++);})},handlePage(t){console.log(t),this.pageData.page=t,this.current_page=t,this.searchValue===""?this.Loadcustomerdata():this.loadcustomerdataSub()},JudgeUserType(t){return t==="manager"},loadcustomerdataSub(){n.get(`http://43.143.167.222:8020/Customer/?CNAME=${this.newValue_search}`).then(t=>{console.log(t.data),this.orders=[];for(let s=(this.pageData.page-1)*this.pageData.limit,a=0;a<this.pageData.limit&&(this.orders[a]=t.data[s],a++,s!==t.data.length-1);s++);this.total=t.data.length||0})}}},S={class:"customerpage"},O={class:"head"},E=e("div",{class:"title"},[e("strong",null,"客户订单列表")],-1),F={key:0,class:"card-body"},J={class:"form-inline"},L=e("div",{class:"input-group mb-2 mr-sm-2"},[e("div",{class:"input-group-prepared"},[e("div",{class:"input-group-text"},"客户搜索:")])],-1),j={class:"like_table"},U=e("span",{class:"like-th"},null,-1),A={class:"short_data"},M={class:"tr_OrderId"},H={class:"tr_CustName"},K={class:"tr_ProductName"},R={class:"tr_OrderTime"},W={class:"tr_OrderStatus"},z={class:"show_details"},Z={class:"detail_data_incustomer"},q={class:"side_table"},G=e("div",{class:"left_colname"},[e("div",{class:"type_colname"},"产品种类："),e("div",{class:"supplier_colname"},"供应商："),e("div",{class:"Ori_warehouse"},"始发仓库：")],-1),Q={class:"left_detail"},X={class:"pro_type"},Y={class:"pro_supplier"},$={class:"pro_type"},ee=e("div",{class:"middle_colname"},[e("div",{class:"dest_colname"},"目的地："),e("div",{class:"cur_colname"},"当前位置："),e("div",{class:"phone_colname"},"配送员电话：")],-1),te={class:"middle_detail"},se={class:"pro_dest"},ae={class:"pro_cur"},oe={class:"pro_phone"},re=e("div",{class:"right_colname"},[e("div",{class:"dest_colname"},"生产时间："),e("div",{class:"cur_colname"},"过期时间：")],-1),le={class:"right_detail"},ie={class:"pro_dest"},_e={class:"pro_cur"};function ce(t,s,a,r,d,i){const m=_("el-tag"),v=_("ion-icon"),D=_("el-main"),f=_("el-pagination"),C=_("el-scrollbar"),y=_("el-card");return h(),u("div",S,[e("div",O,[E,i.JudgeUserType(this.user)?(h(),u("div",F,[e("div",J,[L,P(e("input",{onKeyup:s[0]||(s[0]=I(o=>d.searchValue="",["esc"])),"onUpdate:modelValue":s[1]||(s[1]=o=>d.searchValue=o),type:"text",class:"form-control"},null,544),[[b,d.searchValue]])])])):T("",!0)]),c(y,{class:"customerCard"},{default:p(()=>[c(C,{class:"blockdetail_rightpart"},{default:p(()=>[c(D,{style:{padding:"0"}},{default:p(()=>[e("div",j,[U,(h(!0),u(w,null,B(d.orders,(o,g)=>(h(),u("span",{class:"like_tr",key:o.orderdetail__OrderDetail_ID},[e("div",A,[e("div",M,[e("div",null,"详情号："+l(g+1+(this.current_page-1)*this.pageData.limit),1)]),e("div",H,[e("div",null,"顾客名称："+l(o.Customer_ID__Customer_Name),1)]),e("div",K,[e("div",null,"订购产品："+l(o.orderdetail__ProductBatch_ID__Product_ID__Product_Name),1)]),e("div",R,[e("div",null,"订单时间："+l(i.replace(o.Order_Time)),1)]),e("div",W,[c(m,{type:i.JudgeColor_FromNum(o.delivery__Current_Status)},{default:p(()=>[V(l(i.JudgeText_FromNum(o.delivery__Current_Status)),1)]),_:2},1032,["type"])]),e("div",z,[c(v,{id:"collapselink",name:"chevron-down-outline",class:"detail_click",onClick:de=>i.Rotate_and_show(g)},null,8,["onClick"])])]),e("div",Z,[e("div",q,[G,e("div",Q,[e("div",X,l(o.orderdetail__ProductBatch_ID__Product_ID__Product_Type),1),e("div",Y,l(o.orderdetail__ProductBatch_ID__Supplier_ID__Supplier_Name),1),e("div",$,l(o.orderdetail__ProductBatch_ID__WareHouse_ID__WareHouse_Name),1)]),ee,e("div",te,[e("div",se,l(o.Order_Destination),1),e("div",ae,l(o.delivery__Current_Position),1),e("div",oe,l(o.delivery__Dispatcher_ID__Dispatcher_Tel),1)]),re,e("div",le,[e("div",ie,l(i.replace(o.orderdetail__ProductBatch_ID__ProductBatch_Production_Time)),1),e("div",_e,l(i.replace(o.orderdetail__ProductBatch_ID__ProductBatch_Expiration_Time)),1)])])])]))),128))])]),_:1}),c(f,{layout:"prev, pager, next","current-page":this.current_page,total:d.total,"page-size":16,onCurrentChange:i.handlePage},null,8,["current-page","total","onCurrentChange"])]),_:1})]),_:1})])}const pe=N(x,[["render",ce]]);export{pe as default};
